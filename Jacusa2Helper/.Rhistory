x
str(x)
list(1, 2, 3, 4)
list(list(1), 2, 3, 4)
ToBases(matrix12)
devtools::load_all(".")
ToBases(matrix12)
ToBases(matrix12)
devtools::load_all(".")
devtools::load_all(".")
ToBases(matrix12)
m <- ToBases(matrix12)
split(m, rep(1, ncol(m), each = nrow(m)))
m
split(m, ncol(m))
split(m, 1:ncol(m))
devtools::load_all(".")
ToBases(matrix12)
devtools::load_all(".")
ToBases(matrix12)
names(ToBases(matrix12)) <- NULL
names(ToBases(matrix12))
as.numeric(names(ToBases(matrix12)))
bases11 <- c("10,0,0,0", "0,0,0,10", "5,0,0,0")
bases21 <- c("5,5,0,0", "0,0,5,10", "5,0,0,0")
bases22 <- c("5,10,0,0", "0,0,10,10", "20,0,0,0")
l <- list(
bases11 = bases11,
bases21 = bases21,
bases22 = bases22
)
l <- AddBaseMatrixInfo(l)
l
AddBaseInfo(l)
ToBase(l$matrix1)
ToBases(l$matrix1)
ToBases(l$matrix1)
devtools::load_all(".")
ToBases(l$matrix1)
l$matrix1
apply(l$matrix1, 1, function(x) { names(x)[x > 9]} )
apply(l$matrix1, 1, function(x) { names(x)[x > 9]})
is.list(apply(l$matrix1, 1, function(x) { names(x)[x > 9]}))
ToBases(l$matrix1)
ToBases(l$matrix1)
devtools::load_all(".")
devtools::load_all(".")
ToBases(l$matrix1)
matrix(ToBases(l$matrix1))
matrix(c("A", "T", "A"))
c("A", "C", "G")
list(c("A", "C", "G"))
as.list(c("A", "C", "G"))
devtools::load_all(".")
matrix(ToBases(l$matrix1))
devtools::load_all(".")
matrix(ToBases(l$matrix1))
matrix(ToBases(l$matrix1))
devtools::load_all(".")
matrix(ToBases(l$matrix1))
devtools::load_all(".")
matrix(ToBases(l$matrix1))
devtools::load_all(".")
matrix(ToBases(l$matrix1))
devtools::load_all(".")
matrix(ToBases(l$matrix1))
ToBases(l$matrix1)
ToBases(l$matrix2)
devtools::load_all(".")
ToBases(l$matrix2)
library(Jacusa2Helper)
matrix12 <- .get_matrix(c(10,5,0,0,  0,10,5,0,  0,0,10,5,  5,0,0,10))
matri12
matrix12
ToBase(matrix12)
ToBases(matrix12)
ToBases
apply(matrix12, 1, function(x) { names(x)[x > 1] })
d <- apply(matrix12, 1, function(x) { names(x)[x > 1] })
split(d, 1:ncol(d))
library(Jacusa2Helper)
ToBase(matrix12)
source('~/.active-rstudio-document')
library(Jacusa2Helper)
library(Jacusa2Helper)
library(Jacusa2Helper)
library(Jacusa2Helper)
library(Jacusa2Helper)
library(Jacusa2Helper)
library(Jacusa2Helper)
source('~/.active-rstudio-document')
devtools::document()
devtools::document()
devtools::load_all(".")
devtools::use_data_raw()
devtools::use_data()
library("JacusaHelper")
data(siADAR_untr_hek293_rrds)
rrd <- siADAR_untr_hek293_rrds
devtools::use_data(rrd)
data(untr_hek293_rdds)
rdd <- untr_hek293_rdds
devtools::use_data(rdd)
library(Jacusa2Helper)
library(Jacusa2Helper)
devtools::load_all(".")
.get_data()
.get_data() {
l <- list(
contig = c(1, 2, 3, 4),
bases1 = list(
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0", "0,10,0,1"),
bases12 = c("10,0,0,0", "0,10,0,0", "0,0,10,2", "0,10,0,1")
),
bases2 = list(
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,10,2", "0,10,1,1"),
bases22 = c("10,0,0,2", "0,10,0,0", "0,0,10,2", "0,10,0,1")
)
)
add_bc_matrix(l)
}
.get_data() {
l <- list(
contig = c(1, 2, 3, 4),
bases1 = list(
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0", "0,10,0,1"),
bases12 = c("10,0,0,0", "0,10,0,0", "0,0,10,2", "0,10,0,1")
),
bases2 = list(
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,10,2", "0,10,1,1"),
bases22 = c("10,0,0,2", "0,10,0,0", "0,0,10,2", "0,10,0,1")
)
)
add_bc_matrix(l)
}
library(Jacusa2Helper)
library(Jacusa2Helper)
library(Jacusa2Helper)
devtools::load_all(".")
# create test data
bases11 <- c("10,5,0,0", "10,0,5,10", "0,0,0,0", "5,5,5,5")
bases21 <- c("0,5,0,0", "0,0,5,10", "0,0,0,0", "5,0,0,5")
bases22 <- bases11
l <- list(
bases11 = bases11,
bases21 = bases21,
bases22 = bases22
)
l
l <- add_bc_matrix(l)
devtools::load_all(".")
l
l <- add_bc_matrix(l)
l
devtools::load_all(".")
format_bc_change(c("A", "T", "A"), c("C", "G", "no change")
)
format_bc_change(c("A", "T"), c("C", "G", "no change")
)
format_bc_change(c("A", "T", "A"), c("C", "G", "A")
)
format_bc_change(c("A", "T", ""), c("C", "G", "")),
format_bc_change(c("A", "T", ""), c("C", "G", ""))
l <- list(
bases11 = c("10,0,0,0", "0,0,0,10", "5,0,0,0"),
bases21 = c("5,5,0,0", "0,0,5,10", "5,0,0,0"),
bases22 = c("5,10,0,0", "0,0,10,10", "20,0,0,0")
)
l <- add_bc_matrix(l)
l <- add_bc(l)
l
format_bc_change("A", "G")
devtools::load_all(".")
ger_bc_change(c("A"), c("G"))
get_bc_change(c("A"), c("G"))
get_comp_bc
list("AG")
get_bc
devtools::load_all(".")
bc <- list(c("A", "G"), "C", c("C", "G"))
bc
get_comp_bc(bc)
.get_data <- function() {
l <- list(contig = c(1, 2, 3, 4),
bases11 = c("10,0,0,0", "0,10,0,0",	"0,0,10,0", "0,0,0,10"),
bases21 = c("5,0,0,0", "0,5,0,5", "0,0,5,0", "0,0,0,5"),
bases22 = c("0,0,25,0", "0,0,0,20", "0,0,0,0", "0,0,5,0"))
l <- add_coverage(l)
l
}
l <- .get_data()
length(l$contig)
r <- filter_coverage(l, field = "cov", 40)
r
r <- filter_coverage(l, field = c("cov1", "cov2"), c(20, 20))
r
.get_data <- function() {
l <- list(
contig = c(1, 2, 3),
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0"),
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,10,0"),
bases22 = c("10,0,0,2", "0,10,0,1", "0,0,10,2")
)
l <- add_bc_matrix(l)
l <- add_bc(l)
l
}
l
l <- .get_data()
l
filter_min_variant_count(l)
filter_min_variant_count(l)
get_variant_count(l$bc1, l$bc2, l$bc_matrix2)
l
l$bc1
l$bc2
v <- mapply(function(x, y) { gsub(x, "N", y) }, bc1, bc2, USE.NAMES = FALSE)
i <- match(v, c(.BASES, "N"))
v <- mapply(function(x, y) { gsub(x, "N", y) }, l$bc1, l$bc2, USE.NAMES = FALSE)
v
l
v <- mapply(function(x, y) { gsub(x, "N", y) }, l$bc1, l$bc2, USE.NAMES = FALSE)
v
match(v, c(BASES, "N"))
match(v, c(.BASES, "N"))
v <- mapply(function(x, y) { gsub(x, "N", y) }, get_bcs(l$bc_matrix1), get_bcs(l$bc_matrix2), USE.NAMES = FALSE)
v
match(v, BASES)
match(v, .BASES)
match(v, c(.BASES, "N"))
devtools::load_all(".")
devtools::load_all(".")
library(Jacusa2Helper)
library(Jacusa2Helper)
.get_data_no_rep <- function() {
l <- list(
bases1 = list(
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0", "0,10,0,1")
),
bases2 = list(
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,0,2", "0,10,0,1")
)
)
l <- add_bc_matrix(l)
l <- add_bc(l)
}
l <- .get_data_no_rep()
l
get_robust_variant_index(l$bc_matrix1, l$bc_matrix2)
.get_data <- function() {
l <- list(
bases1 = list(
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0", "0,10,0,1"),
bases12 = c("10,0,0,0", "0,10,0,0", "0,0,10,2", "0,10,0,1")
),
bases2 = list(
bases21 = c("10,0,0,0", "0,10,0,1", "0,0,10,2", "0,10,0,1"),
bases22 = c("10,0,0,2", "0,10,0,0", "0,0,10,2", "0,10,0,1")
)
)
l <- add_bc_matrix(l)
l <- add_bc(l)
}
.get_data()
l <- .get_data()
.get_data()
l
filter_robust_variants(l)
.get_data_no_rep <- function() {
l <- list(
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0", "0,10,0,1"),
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,0,2", "0,10,0,1"))
l <- add_bc_matrix(l)
l <- add_bc(l)
l
}
l <- .get_data_no_rep()
l
get_robust_variant_index(l$bc_matrix1, l$bc_matrix2)
filter_robust_variants(l)
l <- .get_data()
l
filter_robust_variants(l)
.get_data()
.get_data()
.get_data()
l <- get_data()
l <- .get_data()
l
get_robust_variant_index(l$bc_matrix1, l$bc_matrix2)
filter_robust_variants(l)
l <- list(
bases11 = c("10,0,0,0", "0,0,0,10", "5,1,0,0"),
bases21 = c("5,5,0,0", "0,0,5,10", "5,1,0,0"),
bases22 = c("5,10,0,0", "0,0,10,10", "20,1,0,0")
)
l <- add_bc_matrix(l)
l <- add_bc(l)
l
format_bc_change(c("A", "T", ""), c("C", "G", ""))
get_bc_change(l$bc1, l$bc2, l$bc_matrix2)
gsub(("AG", "", "A"))
gsub("AG", "", "A")
gsub("A\|G", "", "A")
gsub("A|G", "", "A")
l <- list(
bases11 = c("10,0,0,0", "0,0,0,10", "5,0,0,0"),
bases21 = c("5,5,0,0", "0,0,5,10", "5,0,0,0"),
bases22 = c("5,10,0,0", "0,0,10,10", "20,0,0,0"))
l <- add_bc_matrix(l)
l <- add_bc(l)
l
l
get_bc_change_ratio(l$bc1, l$bc2, l$bc_matrix2)
get_bc_change_ratio(l$bc1, l$bc2, l$bc_matrix2)
devtools::load_all(".")
get_bc_change_ratio(l$bc1, l$bc2, l$bc_matrix2)
devtools::load_all(".")
get_bc_change_ratio(l$bc1, l$bc2, l$bc_matrix2)
reads11 <- c("5,10,0", "2,10,5", "3,10,10", "10,0,10")
reads12 <- c("0,20,0", "3,15,5", "2,30,30", "1,2,5")
reads13 <- c("0,30,0", "3,5,5", "2,20,20", "1,3,6")
l <- list(reads11 = reads11,
reads12 = reads12,
reads13 = reads13)
l
e <- list(read11 = matrix(c(5,10,0, 2,10,5, 3,10,10, 10,0,10),
byrow = T, ncol = 3,
dimnames = list(c(), .READ)),
read12 = matrix(c(0,20,0, 3,15,5, 2,30,30, 1,2,5),
byrow = T, ncol = 3,
dimnames = list(c(), .READ)),
read13 = matrix(c(0,30,0, 3,5,5, 2,20,20, 1,3,6),
byrow = T, ncol = 3,
dimnames = list(c(), .READ)))
e
read_str2read_matrix(l)
e
e
read_str2read_matrix(l)
expect_identical
devtools::load_all(".")
reads11 <- c("5,10,0", "2,10,5", "3,10,10", "10,0,10")
reads12 <- c("0,20,0", "3,15,5", "2,30,30", "1,2,5")
reads13 <- c("0,30,0", "3,5,5", "2,20,20", "1,3,6")
l <- list(reads11 = reads11,
reads12 = reads12,
reads13 = reads13)
e <- list(read11 = matrix(c(5,10,0, 2,10,5, 3,10,10, 10,0,10),
byrow = T, ncol = 3,
dimnames = list(c(), .READ)),
read12 = matrix(c(0,20,0, 3,15,5, 2,30,30, 1,2,5),
byrow = T, ncol = 3,
dimnames = list(c(), .READ)),
read13 = matrix(c(0,30,0, 3,5,5, 2,20,20, 1,3,6),
byrow = T, ncol = 3,
dimnames = list(c(), .READ)))
l
l <- read_str2read_matrix(l)
l
l == e
str(l)
str(e)
library(Jacusa2Helper)
library(Jacusa2Helper)
jacusa <- add_bc_matrix(rdd)
jacusa <- add_bc(jacusa)
jacusa <- add_bc_change(jacusa)
jacusa <- add_bc_change_ratio(jacusa)
jacusa
str(jacusa)
jacusa <- add_bc_matrix(rdd)
jacusa <- add_bc(jacusa)
variant_count <- get_variant_count(jacusa$bc1, jacusa$bc2, jacusa$bc_matrix2)
str(variant_count)
lapply(variant_count, function(x) x >= 10)
lapply(variant_count, function(x) browser() )
m <- do.call(cbind, variant_count)
str(m)
head(m)
l
l <- .get_data()
str(l)
l <- add_bc_change(rdd)
table(l$bc_change)
str(l)
l <- add_bc_change(rdd)
l
str(l)
l <- add_bc(rdd)
l <- add_bc_matrix(rdd)
l <- add_bc(l)
l <- add_bc_change(l)
table(l$bc_change)
sum(table(l$bc_change))
table(l$bc_change)
score_bc_change(table(l$bc_change))
library(Jacusa2Helper)
c("A", "AG")
nchar(c("A", "AG"))
nchar(c("A", "AG")) >= 2
any(nchar(c("A", "AG")) >= 2)
l <- .get_data()
count <- get_variant_count(l$bc1, l$bc2, l$bc_matrix2)
l
count
l
l <- list(
contig = c(1, 2, 3),
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0"),
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,10,0"),
bases22 = c("10,0,0,2", "0,10,0,1", "0,0,10,2")
)
l <- add_bc_matrix(l)
l <- add_bc(l)
l
l
l <- .get_data()
l
devtools::load_all(".")
l <- .get_data
l
l
l <- .get_data()
l
devtools::load_all(".")
.get_data()
.get_data <- function() {
l <- list(
contig = c(1, 2, 3),
bases11 = c("10,0,0,0", "0,10,0,0", "0,0,10,0"),
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,10,0"),
bases22 = c("10,0,0,2", "0,10,0,1", "0,0,10,2")
)
l <- add_bc_matrix(l)
l <- add_bc(l)
l
}
.get_data()
count <- get_variant_count(l$bc1, l$bc2, l$bc_matrix2)
l
l <- .get_data()
l
l
get_variant_count(l$bc1, l$bc2, l$bc_matrix2)
l <- .get_invalid_data(
l <- .get_invalid_data()
)
l <- .get_invalid_data()
.get_invalid_data <- function() {
l <- list(
contig = c(1, 2, 3),
bases11 = c("10,0,0,1", "0,10,1,0", "0,0,10,0"),
bases21 = c("10,0,0,2", "0,10,0,1", "0,0,10,0"),
bases22 = c("10,0,0,2", "0,10,0,1", "0,0,10,2")
)
l <- add_bc_matrix(l)
l <- add_bc(l)
l
}
l <- .get_invalid_data()
l
get_variant_count(l$bc1, l$bc2, l$bc_matrix2)
get_variant_count(l$bc1, l$bc2, l$bc_matrix2)
"Too many (>=2) alleles for condition 1"
data <- add_bc_matrix(rdd)
data <- add_bc(rdd)
data <- add_bc(data)
JACUSA2VCF(data, ref = data$bc1)
l
.get_data()
l <- .get_data()
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
View(alt)
devtools::load_all(".")
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
View(alt)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
gsub
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
l$config <- c(1, 2, 3)
l$strand <- c(".", ".", ".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
JACUSA2VCF(l, ref = l$bc1)
l$end <- c(1, 2, 3)
JACUSA2VCF(l, ref = l$bc1)
l$name <- c("A", "B", "C")
JACUSA2VCF(l, ref = l$bc1)
devtools::load_all(".")
library(Jacusa2Helper)
